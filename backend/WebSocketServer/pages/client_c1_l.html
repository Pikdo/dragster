<!DOCTYPE html>
<html>

<head>
    <title>Remote Rally</title>
</head>

<body>
    <div>
        Driver 1 Left tire
    </div>
    <div> </div>

    Turbo
    <div ontouchstart="turboCommand()" style="background-color: rgb(221, 36, 30); height: 100px; width: 100px;">
    </div>
    Foreward
    <div ontouchstart="forewardCommand('D')" ontouchend="forewardCommand('U')" onmousedown="forewardCommand('D')" onmouseup="forewardCommand('U')" style="background-color: green; height: 100px; width: 100px;">
    </div>
    backward
    <div ontouchstart="backwardCommand('D')" ontouchend="backwardCommand('U')" onmousedown="backwardCommand('D')" onmouseup="backwardCommand('U')" style="background-color: blue; height: 100px; width: 100px;">
    </div>

    <div></div>
    Received message
    <!-- <div style="background-color: rgb(221, 36, 30); height: 100px; width: 100px;"> -->
    <div id="ShowReceivedMessage">
</body>
<script>
    //const serverName = 'ws://192.168.1.69';
    const serverName = 'wss://remotecarcontrol.herokuapp.com';
    const ws = new WebSocket(serverName + '/driver/1/l');

    const divMessage = document.getElementById('ShowReceivedMessage');

    ws.onopen = function() {
        //console.log('WebSocket Client Connected');
        //ws.send('Hi this is web client.');
        //ws.pingInterval = setInterval(() => ws.ping(), 1000 * 45);
    };

    ws.onclose = function() {
        //console.log('WebSocket Client Connected');
        //ws.send('Hi this is web client.');
        //clearInterval(ws.pingInterval);
    };

    ws.onmessage = function(e) {
        divMessage.innerHTML = e.data;
    };

    function forewardCommand(event) {
        // console.log("forewardMouseDown");
        if (event === 'D' || event === 'U') {
            ws.send('{LF' + event + '}');
        }
    }

    function backwardCommand(event) {
        // console.log("forewardMouseDown");
        if (event === 'D' || event === 'U') {
            ws.send('{LB' + event + '}');
        }
    }

    function turboCommand() {
        ws.send('{GTD}');
    }
</script>

</html>