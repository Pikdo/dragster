(()=>{"use strict";let e={nombre:"",control:""};const n=document.getElementById("header"),t=document.getElementById("content");async function o(n){""!==n?"#/registro"!==location.hash&&""!==location.hash||(e.nombre=n,location.hash="#/controles"):alert("Registre un nombre para poder ingresar")}const a=async()=>{n.innerHTML='\n    <div class="header-title">        \n        <p class="header-title__dragster">DRAGSTER</p>\n        <p class="header-title__race">RACE</p>\n    </div>\n    ';let a=location.hash.slice(1).toLocaleLowerCase().split("/")[1]||"/";switch(await(i=a,i.length<=3?"/"===i?i:"/:id":`/${i}`)){case"/":case"/registro":t.innerHTML='\n    <div class="form">        \n        <h2 class="form__titulo">REGISTRO</h2>\n        <div class="separador"></div>        \n            <input\n                type="text"\n                name="txt_name_player"\n                id="txt_name_player"\n                placeholder="Digite su nombre"\n                required\n                class="form_input"\n            />\n            <input\n                type="button"\n                id="btn_registrar"\n                name="btn_registrar"\n                class="form_input form_button"\n                value="INGRESAR"\n            />        \n        <div id="titulo" class="mensaje"></div>\n    </div>\n    ',s=document.getElementById("btn_registrar"),r=document.getElementById("txt_name_player"),s&&(s.addEventListener("click",(function(){console.log(r.value),o(r.value)})),s.addEventListener("keypress",(function(e){console.log(e),13===e.code&&(e.preventDefault(),o(r.value))})));break;case"/controles":if(""===e.nombre){location.hash="#/registro";break}const n=await(async e=>{try{const n=await fetch("http://remotecarcontrol.herokuapp.com/driver",{headers:{Accept:"application/json","Content-Type":"application/json"},method:"POST",body:JSON.stringify({name:e})}).catch((e=>{console.error("Fetch Error:"+e)}));let t=await n.json();return console.log(t),t.car?(t.nombre=("A"===t.motor?"‚Üï ":"‚Üî ")+e,t.emoji=function(){const e=["üòè","üòé","üòç","ü§ñ","üò∫","ü§†","ü§ë","üòÅ","üòä","üëΩ","ü•∞","ü§©","ü§ó","üòõ"];return e[Math.round(Math.random()*(e.length-1))]}(),t):(alert("üòÖ Ya hay 4 jugadores registrados, espere a la siguiente carrera"),void(location.hash="#/registro"))}catch(e){console.error("Error al obtener driver: "+e)}})(e.nombre);t.innerHTML=(e=>`\n        <div id="controles" class="form">\n            <div class="form_titulos">\n                <div class="form__titulos_left">\n                    <h2 class="form__titulo">üöòüì° CARRO ${e.car}</h2>\n                </div>\n                <div class="form__titulos_right">\n                    <h2 class="form__titulo estado" id="estado">Por iniciar...</h2>\n                </div>\n            </div>\n\n            <div class="separador"></div>\n            <div class="controles_container">\n                <div id="controles_up_down" class="controles_up_down">\n                    <input type="button" id="btn_up" name="btn_up" class="arrow up" value="‚ñ≤" />\n                    <input type="button" id="btn_down" name="btn_down" class="arrow down" value="‚ñº" />\n                </div>\n                <div id="controles_left_right" class="controles_left_right">\n                    <input type="button" id="btn_left" name="btn_left" class="arrow izquierda" value="‚óÄ" />\n                    <input type="button" id="btn_right" name="btn_right" class="arrow down" value="‚ñ∂" />\n                </div>\n            </div>\n            <div class="jugadores_container">\n                <div class="jugador_up_down">\n                    <p class="nombre_jugador_1">${e.emoji} ${e.nombre}</p>\n                </div>\n                <div class="jugador_left_right">\n                    <p class="nombre_jugador_2"></p>\n                </div>\n            </div>\n            <hr />\n            <div id="text_equipo" class="mensaje">EQUIPO</div>\n        </div>\n    `)(n),(async e=>{const n=new WebSocket("ws://remotecarcontrol.herokuapp.com"+e.uri);function t(t){"D"!==t&&"U"!==t||n.send("{"+e.motor+"F"+t+"}")}function o(t){"D"!==t&&"U"!==t||n.send("{"+e.motor+"B"+t+"}")}var a,s,r,i,l,d;n.onopen=function(){console.log("WebSocket Client conectado: ",e.uri),n.pingInterval=setInterval((()=>{console.log("Mantener vivo WebSocket"),n.send("{P}")}),2e3)},n.onclose=function(e){clearInterval(n.pingInterval),console.log("WebSocket Client close"),document.getElementById("estado").innerHTML="Carrera finalizada"},n.onmessage=function(n){var t,o,a,s;'{"winner":"1"}'!==n.data&&'{"winner":"2"}'!==n.data?(document.getElementById("estado").innerHTML=n.data,async function(){let n="https://remotecarcontrol.herokuapp.com/driverNames/"+e.car;console.log(n);const t=await fetch(n,{headers:{Accept:"application/json","Content-Type":"application/json"},method:"GET"}).catch((e=>{console.error("Error fetch equipo: "+e)})),o=await t.json();console.log("Equipo",o)}()):(t=n.data,o=JSON.parse(t),a=document.getElementById("text_equipo"),s=null,o.winner==e.car?(a.innerHTML="<p> üòé FELICIDADES ü•á</p>",confetti({particleCount:500}),s=setInterval((()=>{confetti({particleCount:500})}),1500)):a.innerHTML="<p> üòÖ GRACIAS POR PARTICIPAR ü•à</p>",setTimeout((()=>{confetti({particleCount:100,spread:150}),clearInterval(s),location.hash="#/registro"}),1e4))},a=document.getElementById("controles_up_down"),s=document.getElementById("controles_left_right"),r=document.getElementById("btn_up"),i=document.getElementById("btn_down"),l=document.getElementById("btn_left"),d=document.getElementById("btn_right"),"A"===e.motor?(s.style.display="none",console.log("Carga Eventos Aceleraci√≥n"),r.addEventListener("mouseup",(()=>{console.log("btn_adelante suelto"),t("U")})),r.addEventListener("mousedown",(()=>{console.log("btn_adelante presionado"),t("D")})),r.addEventListener("touchstart",(()=>{console.log("btn_adelante presionado"),t("D")})),r.addEventListener("touchend",(()=>{console.log("btn_adelante suelto"),t("U")})),i.addEventListener("mouseup",(()=>{console.log("btn_reversa suelto"),o("U")})),i.addEventListener("mousedown",(()=>{console.log("btn_reversa presionado"),o("D")})),i.addEventListener("touchstart",(()=>{console.log("btn_reversa presionado"),o("D")})),i.addEventListener("touchend",(()=>{console.log("btn_reversa suelto"),o("U")}))):"D"===e.motor&&(a.style.display="none",console.log("Carga Eventos Direcci√≥n"),l.addEventListener("mouseup",(()=>{console.log("btn_izquierda suelto"),t("U")})),l.addEventListener("mousedown",(()=>{console.log("btn_izquierda presionado"),t("D")})),l.addEventListener("touchstart",(()=>{console.log("btn_izquierda presionado"),t("D")})),l.addEventListener("touchend",(()=>{console.log("btn_izquierda suelto"),t("U")})),d.addEventListener("mouseup",(()=>{console.log("btn_derecha suelto"),o("U")})),d.addEventListener("mousedown",(()=>{console.log("btn_derecha presionado"),o("D")})),d.addEventListener("touchstart",(()=>{console.log("btn_derecha presionado"),o("D")})),d.addEventListener("touchend",(()=>{console.log("btn_derecha suelto"),o("U")})))})(n);break;case"/admin":t.innerHTML='<section class="main-container">\n                    <div id="controles" class="form">\n                        <div class="form_titulos">\n                            <div class="form__titulos_left">\n                                <h2 class="form__titulo">üèÅADMIN</h2>\n                            </div>\n                            <div class="form__titulos_right">\n                                <h2 class="form__titulo estado" id="estado">Por iniciar...</h2>\n                            </div>\n                        </div>\n                        <div class="separador"></div>\n                        <div class="jugadores_container">\n                            <div class="jugadores_equipo_1">\n                                <p>CAR 1 üöó</p>\n                                <p class="equipo_1">‚Üï Tavo üòè</p>\n                                <p class="equipo_1">‚Üî Leo üòÆ</p>\n                            </div>\n                            <div><p class="versus">VS</p></div>\n                            <div class="jugadores_equipo_2">\n                                <p>üöï CAR 2</p>\n                                <p class="equipo_2">ü§† Jose ‚Üï</p>\n                                <p class="equipo_2">üßê Diego ‚Üî</p>\n                            </div>\n                        </div>                                \n                        <form action="post">\n                            <div class="separador"></div>\n                            \n                            <input\n                                type="button"\n                                id="btn_registrar"\n                                name="btn_registrar"\n                                class="form_input form_button"\n                                value="Iniciar/Detener"\n                            />  \n                            <input\n                                type="button"\n                                id="btn_registrar"\n                                name="btn_registrar"\n                                class="form_input form_button"\n                                value="Reiniciar"\n                            />                 \n                    </div>\n                </section>',console.log("Cargar controles de administraci√≥n")}var s,r,i};window.addEventListener("load",a),window.addEventListener("hashchange",a)})();